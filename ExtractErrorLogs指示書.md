# VBAツール作成指示書：ログ抽出マクロ（Log Extractor）

## 1. 概要
指定したフォルダ内にある複数のExcelブックを自動で巡回し、特定のキーワード（エラー情報）が含まれるセルを抽出して、一覧表を作成する。

## 2. 処理フロー
1.  **フォルダ選択**
    - `Application.FileDialog(msoFileDialogFolderPicker)` を使用。
    - ユーザーが処理対象のフォルダをダイアログで選択する。
2.  **ファイル巡回**
    - 選択されたフォルダ内の全Excelファイル（`.xls`, `.xlsx`, `.xlsm`等）をループ処理で1つずつ開く。
    - マクロ実行ブック自体が同一フォルダにある場合は処理対象から除外する。
3.  **データ検索**
    - 各ブックの「**ログ**」という名前のシートを検索対象とする。
    - 「ログ」シートが存在しないブックはエラーを出さずにスキップする。
    - 以下のキーワードを検索する。
        - **大文字の「ERROR」**
        - **大文字の「EXCEPTION」**
4.  **結果集計（書き出し）**
    - ヒットしたセルの情報を、マクロ実行ブックの「Sheet1」へ転記する。
    - 詳細は「3. 出力レイアウト」を参照。
5.  **終了処理**
    - 全ファイルを確認後、画面更新を再開し、抽出件数を添えた完了メッセージを表示する。

## 3. 出力レイアウト（書き出し先：Sheet1）

1行目を見出し行とし、2行目以降にデータを蓄積する。実行のたびに前回データはクリアする。

| 列 | 項目名 | 内容 |
| :--- | :--- | :--- |
| **A列** | ブック名 | 検索ヒットしたExcelファイル名（拡張子含む） |
| **B列** | シート名 | 検索対象シート名（固定で「ログ」） |
| **C列** | セル番号 | ヒットしたセルの番地（例：`$B$10`） |
| **D列** | 区分 | ヒットしたキーワード（`ERROR` または `EXCEPTION`） |
| **E列** | 内容 | ヒットしたセルを**書式（色・枠線等）ごと貼り付け** |

## 4. 技術要件・制約事項
- **検索ロジック**
    - 大文字・小文字を厳密に区別すること（`MatchCase:=True`）。
    - セル内の一部分にキーワードが含まれている場合も抽出対象とする（部分一致）。
- **動作の安定化・高速化**
    - `Application.ScreenUpdating = False` により画面更新を停止する。
    - ブックは「読み取り専用（`ReadOnly:=True`）」で開き、保存せずに閉じる。
- **エラーハンドリング**
    - フォルダ選択がキャンセルされた場合は、処理を安全に中断すること。
    - 検索中にキーワードが見つからない場合も次の処理へ正常に遷移すること。

## 5. メンテナンス用変数（推奨）
- 検索キーワード（`ERROR`, `EXCEPTION`）は配列（Array）で管理し、将来的なキーワード追加を容易にする。
